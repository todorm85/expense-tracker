@page
@model ExpenseTracker.Web.Pages.Transactions.YearMonthCategoryModel

<div class="text-center">
    <form method="post">

        <h5 class="row justify-content-center mt-1">
            <span class="text-center d-inline-block">
                <span class="d-inline-block w-100">Expense</span>
                <span class="badge">@Model.TotalExpense.ToString("N0") / @Model.AverageExpense.ToString("N0")</span>
            </span>
            <span class="text-center d-inline-block">
                <span class="d-inline-block w-100">Income</span>
                <span class="badge">@Model.TotalIncome.ToString("N0") / @Model.AverageIncome.ToString("N0")</span>
            </span>
            @{ var avgBalClass = (Model.AverageBalance >= 0) ? "success" : "danger"; }
            <span class="d-inline-block text-center">
                <span class="d-inline-block w-100">Balance</span>
                <span class="badge badge-@avgBalClass">@Model.Balance.ToString("N0") / @Model.AverageBalance.ToString("N0")</span>
            </span>
        </h5>

        <partial name="_Filters" for="Filters" />

        @if (Model.ExpandableMonths.Count > 0)
        {
            <div class="text-left border rounded mb-3">
                @foreach (var catAvg in Model.CategorySummaries)
                {
                    var catBalClass = (catAvg.Totals > 0) ? "success" : "danger";
                    var catBalAvgClass = (catAvg.Average > 0) ? "success" : "danger";

                    <div class="d-inline-block p-2 m-1 bg-light border rounded">
                        <span class="badge badge-secondary mr-1">@(string.IsNullOrEmpty(catAvg.Name) ? "Unspecified" : catAvg.Name)</span>
                        <span>@catAvg.Totals.ToString("N0")</span> |
                        <span class="text-secondary">@catAvg.Average.ToString("N0")</span>
                    </div>
                }
            </div>

            @for (int mi = 0; mi < Model.ExpandableMonths.Count; mi++)
            {
                <partial name="_ExpandableMonth" for="@Model.ExpandableMonths[mi]" />
            }
        }
        else
        {
            <div class="alert-warning alert">No transactions found.</div>
        }
    </form>
</div>