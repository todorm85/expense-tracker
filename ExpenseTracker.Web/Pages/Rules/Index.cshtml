@page
@model ExpenseTracker.Web.Pages.Rules.IndexModel

<form method="post">
    <h1>Rules for adding transactions</h1>
    <button class="btn btn-primary" type="button" data-toggle="modal" data-target="#createRuleModal">Create</button>
    <modal id="createRuleModal" title="Create rule">
        <partial name="_Edit" for="CreateRuleModel" />
    </modal>
    @for (int i = 0; i < Model.Rules.Count; i++)
    {
        var rule = Model.Rules[i];
        <div class="row my-2">
            <div class="col-9">
                <div class="row align-items-start">
                    <div class="d-inline-block">
                        If <span class="font-weight-bold text-lowercase">@rule.Property</span>
                        <span class="text-lowercase mr-4">@rule.Condition</span>
                    </div>
                    <div class="d-inline-block">
                        <span class="d-inline-block font-italic font-weight-bold" style="width:20em">"@rule.ConditionValue"</span>
                    </div>
                    <div class="d-inline-block">
                        then
                        @if (rule.Action == Core.Transactions.Rules.RuleAction.Skip)
                        {
                            <span class="font-weight-bold"> skip.</span>
                        }
                        else
                        {
                            <text>set </text>
                            <span class="font-weight-bold text-lowercase">@rule.PropertyToSet</span>
                            <text> to </text>
                            <span class="font-weight-bold text-lowercase">@rule.ValueToSet</span>
                        }
                    </div>
                </div>
            </div>
            @{ var modalId = $"editRuleModal_{rule.Id}"; }
            <div class="col btn-group-sm">
                <button class="btn btn-secondary" type="button" data-toggle="modal" data-target="#@(modalId)">Edit</button>
                <button btn-del type="submit" asp-page-handler="delete" asp-route-id="@rule.Id" />
            </div>
        </div>
        <modal id="@modalId" title="Edit rule">
            <partial name="_Edit" for="Rules[i]" />
        </modal>
    }
</form>
